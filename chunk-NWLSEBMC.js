import{a as tt}from"./chunk-ZDDQBIZH.js";import{a as H,b as J,c as K,d as Q}from"./chunk-GESNFUJ3.js";import{b as Z}from"./chunk-YKTRQ4Z5.js";import"./chunk-TYQ7V2OE.js";import"./chunk-ULDYZHME.js";import{a as et}from"./chunk-USP77HTD.js";import"./chunk-5RJVXGPW.js";import"./chunk-XOVMDDJV.js";import"./chunk-UGX3RPLS.js";import{a as z,b as G}from"./chunk-SLGQSYUU.js";import"./chunk-7JRFH5VC.js";import"./chunk-HAWLYCEH.js";import{a as X,b as Y}from"./chunk-ZPRISHFX.js";import"./chunk-AI7ETLR3.js";import{a as U,f as j}from"./chunk-ZZYKJDH4.js";import"./chunk-TWHE6YHH.js";import"./chunk-QECTJLHH.js";import{j as O,k as V,o as E}from"./chunk-24RPCR33.js";import{$a as n,Bb as b,Cb as S,Db as w,Fa as A,Ia as x,Jb as T,Rb as I,Ua as y,Va as v,_a as g,a as p,ab as r,b as m,bb as P,da as c,ea as d,gb as C,ib as h,jb as M,jd as L,kc as k,ma as F,oc as B,pd as W,qd as R,rc as N,rd as q,sd as $,wa as u,wc as D,xb as l}from"./chunk-56QYQVDV.js";function nt(a,it){if(a&1){let t=C();n(0,"button",14),h("click",function(){c(t);let i=M();return d(i.onProcessFiles())}),n(1,"mat-icon"),l(2,"send"),r()()}if(a&2){let t=M();g("disabled",t.isProcessButtonDisabled())}}function ot(a,it){if(a&1){let t=C();n(0,"button",15),h("click",function(){c(t);let i=M();return d(i.onStopProcessing())}),n(1,"mat-icon"),l(2,"stop"),r()()}}var Ft=(()=>{class a extends tt{allFiles=F([]);currentPrompt=I(()=>{let t=this.settings();return{name:t.selectedPrompt.name,type:t.selectedPrompt.type,prompt:`${t.selectedPrompt.promptTextList.length>0?"#INSTRUCTIONS":""}
${t.selectedPrompt.excludeCommonInstructions?"":V.join(`
`)}
${t.selectedPrompt.promptTextList.map(e=>e.text).join(`
`)}

${t.selectedPrompt.role?"#ROLE":""}
${t.selectedPrompt.role}`.trim()}},{equal:(t,e)=>t.name===e.name});constructor(){super()}ngOnInit(){super.ngOnInit()}async onProcessFiles(){this.isProcessing.set(!0),this.allFiles.update(t=>t.map(e=>m(p({},e),{status:"init"})));try{let t=this.allFiles().filter(e=>e.selected);if(t.length===0)throw new Error("No files selected for processing");await this.aiProcessingService.processFiles(t,this.currentPrompt().prompt,this.settings(),this.showAuthenticationAlert.bind(this),this.updateFileItemStatus.bind(this))}finally{this.isProcessing.set(!1),this.allFiles.update(t=>t.map(e=>e.status==="inprogress"?m(p({},e),{status:"unmodified"}):e))}}onStopProcessing(){this.allFiles.update(t=>t.map(e=>e.status==="inprogress"?m(p({},e),{status:"unmodified"}):e)),this.isProcessing.set(!1)}isProcessButtonDisabled(){return!this.currentPrompt().prompt||this.allFiles().length<1||this.isProcessing()}onFileUpdate(t){this.allFiles.set(t)}updateFileItemStatus(t,e,i,s){this.allFiles.update(_=>{let o=_.map(f=>f.path===t.path?m(p({},f),{status:e,code:i,error:s}):f);return o.some(f=>f.path===t.path)||o.push(m(p({},t),{status:e,code:i,error:s})),o})}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=A({type:a,selectors:[["app-ai-agent"]],features:[T([O,E]),x],decls:23,vars:7,consts:[["sidenav",""],[1,"agent-container"],["position","end","mode","side",3,"opened"],[3,"isCompactView"],[1,"toolbar-spacer"],["mat-icon-button","","title","Settings",3,"click"],[1,"agent-content"],[1,"prompt-container"],["appearance","fill",1,"full-width"],["matInput","","placeholder","Type your prompt",3,"ngModelChange","rows","ngModel"],[1,"send-button-container"],["mat-mini-fab","","color","primary",3,"disabled"],["mat-mini-fab","","color","warn","title","Stop Processing"],[3,"allFilesChange","allFiles","acceptReferences"],["mat-mini-fab","","color","primary",3,"click","disabled"],["mat-mini-fab","","color","warn","title","Stop Processing",3,"click"]],template:function(e,i){if(e&1){let s=C();n(0,"mat-sidenav-container",1)(1,"mat-sidenav",2,0),P(3,"app-settings",3),r(),n(4,"mat-sidenav-content")(5,"mat-toolbar")(6,"span"),l(7,"AI Agent"),r(),P(8,"span",4),n(9,"button",5),h("click",function(){return c(s),d(i.toggleSideBarOpen("aiAgent"))}),n(10,"mat-icon"),l(11,"settings"),r()()(),n(12,"div",6)(13,"div",7)(14,"mat-form-field",8)(15,"mat-label"),l(16,"Prompt"),r(),n(17,"textarea",9),w("ngModelChange",function(o){return c(s),S(i.currentPrompt().prompt,o)||(i.currentPrompt().prompt=o),d(o)}),l(18,"          "),r()(),n(19,"div",10),y(20,nt,3,1,"button",11)(21,ot,3,0,"button",12),r()(),n(22,"app-file-manager",13),w("allFilesChange",function(o){return c(s),S(i.allFiles,o)||(i.allFiles=o),d(o)}),r()()()()}if(e&2){let s;u(),g("opened",(s=i.settings().sideBarOpen)==null?null:s.aiAgent),u(2),g("isCompactView",!0),u(14),g("rows",7),b("ngModel",i.currentPrompt().prompt),u(3),v(i.isProcessing()?21:20),u(2),b("allFiles",i.allFiles),g("acceptReferences",!0)}},dependencies:[D,k,B,N,Y,X,R,W,L,$,q,G,z,j,U,Q,J,K,H,Z,et],styles:["#main-content[_ngcontent-%COMP%]{padding-bottom:60px}.send-button-container[_ngcontent-%COMP%]{position:absolute;bottom:8px;right:8px}.agent-container[_ngcontent-%COMP%]{position:absolute;inset:0}mat-sidenav[_ngcontent-%COMP%]{width:300px}.toolbar-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.agent-content[_ngcontent-%COMP%]{padding:16px;max-width:1200px;margin:0 auto}.prompt-container[_ngcontent-%COMP%]{position:relative;margin-bottom:20px}.full-width[_ngcontent-%COMP%]{width:100%}"]})}return a})();export{Ft as AiAgentComponent};
